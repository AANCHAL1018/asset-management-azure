@using Microsoft.AspNetCore.Components.Authorization
@using AssetManagementWASM.Shared

<!-- 
  Root App Component
  -----------------------------------------------------------
  Handles routing, layout, and authentication context.
  The CascadingAuthenticationState ensures the entire app
  is aware of user login state (used by AuthorizeView).
-->

<CascadingAuthenticationState>
    <Router AppAssembly="@typeof(App).Assembly" PreferExactMatches="@true">
        
        <!-- ✅ Route Found -->
        <Found Context="routeData">
            <AuthorizeRouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)">
                
                <!-- 🧭 When route requires authorization but user isn't logged in -->
                <NotAuthorized>
                    <RedirectToLogin />
                </NotAuthorized>

                <!-- ⏳ Optional: Show loading state while checking authentication -->
                <Authorizing>
                    <div class="loading-screen">
                        <p>Loading, please wait...</p>
                    </div>
                </Authorizing>

            </AuthorizeRouteView>
        </Found>

        <!-- ❌ Route Not Found -->
        <NotFound>
            <LayoutView Layout="@typeof(MainLayout)">
                <div class="not-found">
                    <h3>404 - Page Not Found</h3>
                    <p>Sorry, the page you’re looking for doesn’t exist.</p>
                </div>
            </LayoutView>
        </NotFound>

    </Router>
</CascadingAuthenticationState>
